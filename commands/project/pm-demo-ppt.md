# Generate Demo PowerPoint

Convert slide-content markdown into a `.pptx` file with corporate theming and speaker notes.

**Usage:** `/pm-demo-ppt [PROJECT_PATH]`

**Arguments:**
- `$ARGUMENTS` - Path to project folder containing `demo/Demo_Showcase_Content.md` (or legacy `PPT_Slide_Content.md`)

---

## Prerequisites

- Slide-content markdown exists in `demo/` subfolder (generated by `/pm-demo-content`)
- Python 3 with `python-pptx` package installed (`pip3 install python-pptx`)
- Optional: `Pillow` package for image embedding (`pip3 install Pillow`)
- Corporate template: `docs/templates/Demo_Template.pptx` (always use `--template` for company branding)

---

## Supported Input Formats

| Format | File | Speaker Notes Source |
|--------|------|---------------------|
| **Merged** (preferred) | `Demo_Showcase_Content.md` | Inline `**Script:**` blocks |
| **Legacy** | `PPT_Slide_Content.md` | Companion `Demo_Showcase_Script.md` |

---

## Agent Instructions

1. **Locate source file** in the project at `$ARGUMENTS`:
   - Prefer `demo/Demo_Showcase_Content.md` (merged format, new location)
   - Fall back to `Demo_Showcase_Content.md` in project root (legacy location)
   - Fall back to `PPT_Slide_Content.md` (legacy format)
   - If none exist, suggest running `/pm-demo-content` first

2. **Check dependencies**:
   ```bash
   python3 -c "import pptx; print('python-pptx OK')"
   ```
   If missing: `pip3 install python-pptx`

3. **Run the converter** (always use `--template` for company branding):
   ```bash
   python3 scripts/md_to_pptx.py [PROJECT_PATH]/demo/Demo_Showcase_Content.md \
     --template docs/templates/Demo_Template.pptx
   ```
   Without `--template`, the script generates plain corporate-themed slides from scratch (no company design, not editable in PowerPoint's Design tab).

4. **Report results** to the user:
   - Output file path
   - Number of slides generated
   - Slide type breakdown (title, bullet, image, closing, placeholder)
   - Whether speaker notes were loaded (inline or companion file)

---

## What the Script Does

`scripts/md_to_pptx.py` handles all conversion logic:

- **Parses markdown** into slide data (title, subtitle, bullets, content, images)
- **Auto-detects slide types**: title, bullet, image, closing, placeholder, comparison
- **Uses template layouts**: maps slide types to template layouts via JSON config
- **Embeds images**: resolves `![alt](file.png)` relative to the markdown file
- **Adds speaker notes**: from inline `**Script:**` blocks (merged) or companion file (legacy)
- **Strips markdown formatting**: removes `**bold**` markers from slide text
- **Names output file** from the `# heading` in the markdown

---

## Template Config System

When `--template` is used, the script loads a JSON config file from alongside the template to map slide types to template layout names and placeholder indices.

**Config file:** Same name as template with `.json` extension (e.g., `Demo_Template.pptx` → `Demo_Template.json`)

| Behavior | When |
|----------|------|
| Load existing config | `Demo_Template.json` exists alongside template |
| Auto-detect and save | No config found — scans layout names, saves `.json` for next time |

### Config Structure

```json
{
  "layouts": {
    "title": "8_Title Colorful Ribbon",
    "bullet": "Picture with Blue Below",
    "image_side": "Picture with Blue Ribbon",
    "image_full": "Thin Blue",
    "closing": "Blue Divider"
  },
  "placeholders": {
    "title": { "title": 0, "subtitle": 1, "date": 13 },
    "bullet": { "title": 0, "content": 1 },
    "image_side": { "title": 0, "text": 2, "picture": 1 },
    "image_full": { "title": 0 },
    "closing": { "content": 14 }
  }
}
```

| Key | Purpose |
|-----|---------|
| `layouts` | Maps slide type → template layout name |
| `placeholders` | Maps slide type → placeholder roles → placeholder index |

### Slide Type to Layout Mapping

| Slide Type | Used For | Placeholder Roles |
|------------|----------|-------------------|
| `title` | First slide (title + subtitle) | `title`, `subtitle`, `date` |
| `bullet` | Content slides with bullet lists | `title`, `content` |
| `image_side` | Bullets + image side by side | `title`, `text`, `picture` |
| `image_full` | Full-width image only | `title` |
| `closing` | Questions / Thank You slide | `content` |

### Customizing for a Different Template

1. Run once with the new template — the script auto-generates a `.json` config
2. Open the generated `.json` and verify layout names match your preferred layouts
3. Adjust placeholder indices if needed (inspect template in PowerPoint: View > Slide Master)
4. Subsequent runs will use the saved config

---

## Slide Type Detection

| Type | Detection | Template Layout | Generic Fallback |
|------|-----------|-----------------|------------------|
| **Title** | Has subtitle, no bullets/content | Config `title` layout | Navy background, white text |
| **Bullet** | Has `**Bullets:**` with `- ` items | Config `bullet` layout | White, navy title, bullet list |
| **Image** | Content has `![alt](file.png)` | Config `image_full` or `image_side` | White, centered image |
| **Closing** | Title contains "Questions" or "Thank You" | Config `closing` layout | Navy, centered text |
| **Placeholder** | Content has `[placeholder text]` | Config `bullet` layout | White, gray placeholder text |

---

## Output

- `.pptx` file saved in `demo/` folder, named from the `# heading`
- **Bullets** go on slides, **Script** goes into speaker notes pane
- Corporate theme applied automatically (or corporate template if `--template` used)

---

## Troubleshooting

| Issue | Solution |
|-------|----------|
| `python-pptx` not installed | `pip3 install python-pptx` |
| `Pillow` not installed (for images) | `pip3 install Pillow` |
| No slides in output | Check markdown follows `## Slide N:` format |
| Image not found | Ensure image file is next to the markdown file |
| Speaker notes missing | Check `**Script:**` blocks exist (merged) or `Demo_Showcase_Script.md` exists (legacy) |
| Can't edit design in PowerPoint | Forgot `--template` flag — regenerate with `--template docs/templates/Demo_Template.pptx` |
| Wrong layouts used | Edit `docs/templates/Demo_Template.json` to pick correct layout names |
| Auto-detected config wrong | Delete `.json`, re-run to regenerate, then manually adjust |
